"use strict";(self.webpackChunkreact_app_ts=self.webpackChunkreact_app_ts||[]).push([[605],{605:(t,e,s)=>{s.r(e),s.d(e,{BackButton:()=>yt,BasicNavigator:()=>Ye,BiometryManager:()=>Ft,BrowserNavigator:()=>ns,ClosingBehavior:()=>Xt,CloudStorage:()=>oe,ERR_INVALID_PATH_BASE:()=>A,ERR_INVOKE_CUSTOM_METHOD_RESPONSE:()=>v,ERR_METHOD_PARAMETER_UNSUPPORTED:()=>w,ERR_METHOD_UNSUPPORTED:()=>b,ERR_NAVIGATION_HISTORY_EMPTY:()=>x,ERR_NAVIGATION_INDEX_INVALID:()=>C,ERR_NAVIGATION_ITEM_INVALID:()=>S,ERR_PARSE:()=>P,ERR_SSR_INIT:()=>T,ERR_TIMED_OUT:()=>y,ERR_UNEXPECTED_TYPE:()=>E,ERR_UNKNOWN_ENV:()=>m,EventEmitter:()=>l,HapticFeedback:()=>ce,InitData:()=>pe,Invoice:()=>de,MainButton:()=>ge,MiniApp:()=>me,Popup:()=>Ee,QRScanner:()=>xe,SDKError:()=>g,SettingsButton:()=>Se,ThemeParams:()=>Re,Utils:()=>Ne,Viewport:()=>Le,array:()=>re,bindMiniAppCSSVars:()=>Ue,bindThemeParamsCSSVars:()=>He,bindViewportCSSVars:()=>Ge,boolean:()=>q,captureSameReq:()=>ot,classNames:()=>ut,compareVersions:()=>F,createBrowserNavigatorFromLocation:()=>rs,createPostEvent:()=>it,createSafeURL:()=>Oe,date:()=>Et,getHash:()=>is,getPathname:()=>ss,initBackButton:()=>Jt,initBiometryManager:()=>Yt,initClosingBehavior:()=>te,initCloudStorage:()=>ae,initHapticFeedback:()=>he,initInitData:()=>ue,initInvoice:()=>_e,initMainButton:()=>fe,initMiniApp:()=>ve,initNavigator:()=>os,initPopup:()=>Pe,initQRScanner:()=>Ce,initSettingsButton:()=>Te,initThemeParams:()=>Ie,initUtils:()=>De,initViewport:()=>Be,initWeb:()=>je,invokeCustomMethod:()=>pt,isColorDark:()=>ft,isIframe:()=>tt,isPageReload:()=>Gt,isRGB:()=>dt,isRGBShort:()=>_t,isSDKError:()=>$e,isSDKErrorOfType:()=>Fe,isSSR:()=>ze,isTMA:()=>Je,json:()=>D,mergeClassNames:()=>lt,mockTelegramEnv:()=>Ke,number:()=>V,off:()=>J,on:()=>K,parseInitData:()=>le,parseLaunchParams:()=>It,parseThemeParams:()=>Ae,postEvent:()=>rt,request:()=>ht,requestBiometryInfo:()=>Qt,requestThemeParams:()=>ke,requestViewport:()=>Ve,retrieveLaunchParams:()=>Ht,rgb:()=>Tt,searchParams:()=>Pt,serializeLaunchParams:()=>Wt,serializeThemeParams:()=>Bt,setCSSVar:()=>We,setDebug:()=>u,setTargetOrigin:()=>st,string:()=>M,subscribe:()=>a,supports:()=>Y,targetOrigin:()=>nt,toRGB:()=>gt,unsubscribe:()=>o,urlToPath:()=>Xe,withTimeout:()=>ct});var n=Object.defineProperty,r=(t,e,s)=>((t,e,s)=>e in t?n(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);function i(t,e){let s;const n=()=>{void 0!==s&&e&&e(s),s=void 0};return[()=>void 0===s?s=t(n):s,n]}function o(t){const e=z(),{count:s}=e;e.unsubscribe(t),s&&!e.count&&j()}function a(t){return z().subscribe(t),()=>o(t)}const c=new class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.scope=t,this.options=e}print(t){const e=new Date,s=Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,timeZone:"UTC"}).format(e),{textColor:n,bgColor:r}=this.options,i="font-weight: bold;padding: 0 5px;border-radius:5px";for(var o=arguments.length,a=new Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];console[t]("%c".concat(s,"%c / %c").concat(this.scope),"".concat(i,";background-color: lightblue;color:black"),"","".concat(i,";").concat(n?"color:".concat(n,";"):"").concat(r?"background-color:".concat(r):""),...a)}error(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this.print("error",...e)}log(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this.print("log",...e)}}("SDK",{bgColor:"forestgreen",textColor:"white"});let h=!1;const p=t=>{let{name:e,payload:s}=t;c.log("Event received:",s?{name:e,payload:s}:{name:e})};function u(t){h!==t&&(h=t,t?a(p):o(p))}class l{constructor(){r(this,"listeners",new Map),r(this,"listenersCount",0),r(this,"subscribeListeners",[])}clear(){this.listeners.clear(),this.subscribeListeners=[]}get count(){return this.listenersCount+this.subscribeListeners.length}emit(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),n=1;n<e;n++)s[n-1]=arguments[n];this.subscribeListeners.forEach((e=>e({event:t,args:s}))),(this.listeners.get(t)||[]).forEach((e=>{let[n,r]=e;n(...s),r&&this.off(t,n)}))}on(t,e,s){let n=this.listeners.get(t);return n||this.listeners.set(t,n=[]),n.push([e,s]),this.listenersCount+=1,()=>this.off(t,e)}off(t,e){const s=this.listeners.get(t)||[];for(let n=0;n<s.length;n+=1)if(e===s[n][0])return s.splice(n,1),void(this.listenersCount-=1)}subscribe(t){return this.subscribeListeners.push(t),()=>this.unsubscribe(t)}unsubscribe(t){for(let e=0;e<this.subscribeListeners.length;e+=1)if(this.subscribeListeners[e]===t)return void this.subscribeListeners.splice(e,1)}}function d(t,e,s){return window.addEventListener(t,e,s),()=>window.removeEventListener(t,e,s)}function _(){let t=!1;for(var e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];const r=s.flat(1);return[e=>!t&&r.push(e),()=>{t||(t=!0,r.forEach((t=>t())))},t]}class g extends Error{constructor(t,e,s){super(e,{cause:s}),this.type=t,Object.setPrototypeOf(this,g.prototype)}}function f(t,e,s){return new g(t,e,s)}const b="ERR_METHOD_UNSUPPORTED",w="ERR_METHOD_PARAMETER_UNSUPPORTED",m="ERR_UNKNOWN_ENV",v="ERR_INVOKE_CUSTOM_METHOD_RESPONSE",y="ERR_TIMED_OUT",E="ERR_UNEXPECTED_TYPE",P="ERR_PARSE",x="ERR_NAVIGATION_LIST_EMPTY",C="ERR_NAVIGATION_CURSOR_INVALID",S="ERR_NAVIGATION_ITEM_INVALID",T="ERR_SSR_INIT",A="ERR_INVALID_PATH_BASE";function R(){return f(E,"Value has unexpected type")}class I{constructor(t,e,s){this.parser=t,this.isOptional=e,this.type=s}parse(t){if(!this.isOptional||void 0!==t)try{return this.parser(t)}catch(e){throw f(P,"Unable to parse value".concat(this.type?" as ".concat(this.type):""),e)}}optional(){return this.isOptional=!0,this}}function k(t,e){return()=>new I(t,!1,e)}const q=k((t=>{if("boolean"==typeof t)return t;const e=String(t);if("1"===e||"true"===e)return!0;if("0"===e||"false"===e)return!1;throw R()}),"boolean");function O(t,e){const s={};for(const r in t){const i=t[r];if(!i)continue;let o,a;if("function"==typeof i||"parse"in i)o=r,a="function"==typeof i?i:i.parse.bind(i);else{const{type:t}=i;o=i.from||r,a="function"==typeof t?t:t.parse.bind(t)}try{const t=a(e(o));void 0!==t&&(s[r]=t)}catch(n){throw f(P,'Unable to parse field "'.concat(r,'"'),n)}}return s}function N(t){let e=t;if("string"==typeof e&&(e=JSON.parse(e)),"object"!=typeof e||null===e||Array.isArray(e))throw R();return e}function D(t,e){return new I((e=>{const s=N(e);return O(t,(t=>s[t]))}),!1,e)}const V=k((t=>{if("number"==typeof t)return t;if("string"==typeof t){const e=Number(t);if(!Number.isNaN(e))return e}throw R()}),"number"),M=k((t=>{if("string"==typeof t||"number"==typeof t)return t.toString();throw R()}),"string");function L(t){return D({eventType:M(),eventData:t=>t}).parse(t)}function B(){["TelegramGameProxy_receiveEvent","TelegramGameProxy","Telegram"].forEach((t=>{delete window[t]}))}function W(t,e){window.dispatchEvent(new MessageEvent("message",{data:JSON.stringify({eventType:t,eventData:e}),source:window.parent}))}const U={clipboard_text_received:D({req_id:M(),data:t=>null===t?t:M().optional().parse(t)}),custom_method_invoked:D({req_id:M(),result:t=>t,error:M().optional()}),popup_closed:{parse:t=>D({button_id:t=>null==t?void 0:M().parse(t)}).parse(null!==t&&void 0!==t?t:{})},viewport_changed:D({height:V(),width:t=>null==t?window.innerWidth:V().parse(t),is_state_stable:q(),is_expanded:q()})};function H(){const t=new l,e=new l;e.subscribe((e=>{t.emit("event",{name:e.event,payload:e.args[0]})})),[["TelegramGameProxy_receiveEvent"],["TelegramGameProxy","receiveEvent"],["Telegram","WebView","receiveEvent"]].forEach((t=>{let e=window;t.forEach(((t,s,n)=>{s!==n.length-1?(t in e||(e[t]={}),e=e[t]):e[t]=W}))}));const[,s]=_(B,d("resize",(()=>{e.emit("viewport_changed",{width:window.innerWidth,height:window.innerHeight,is_state_stable:!0,is_expanded:!0})})),d("message",(t=>{if(t.source!==window.parent)return;let s;try{s=L(t.data)}catch{return}const{eventType:n,eventData:r}=s,i=U[n];try{const t=i?i.parse(r):r;e.emit(...t?[n,t]:[n])}catch(o){c.error('An error occurred processing the "'.concat(n,'" event from the Telegram application.\nPlease, file an issue here:\nhttps://github.com/Telegram-Mini-Apps/telegram-apps/issues/new/choose'),s,o)}})),(()=>t.clear()),(()=>e.clear()));return[{on:e.on.bind(e),off:e.off.bind(e),subscribe:e=>t.on("event",e),unsubscribe(e){t.off("event",e)},get count(){return e.count+t.count}},s]}const[G,j]=i((t=>{const[e,s]=H(),n=e.off.bind(e);return e.off=(s,r)=>{const{count:i}=e;n(s,r),i&&!e.count&&t()},[e,s]}),(t=>{let[,e]=t;return e()}));function z(){return G()[0]}function J(t,e){z().off(t,e)}function K(t,e,s){return z().on(t,e,s)}function $(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function F(t,e){const s=t.split("."),n=e.split("."),r=Math.max(s.length,n.length);for(let i=0;i<r;i+=1){const t=parseInt(s[i]||"0",10),e=parseInt(n[i]||"0",10);if(t!==e)return t>e?1:-1}return 0}function Q(t,e){return F(t,e)<=0}function Y(t,e,s){if("string"==typeof s){if("web_app_open_link"===t){if("try_instant_view"===e)return Q("6.4",s);if("try_browser"===e)return Q("7.6",s)}if("web_app_set_header_color"===t&&"color"===e)return Q("6.9",s);if("web_app_close"===t&&"return_back"===e)return Q("7.6",s)}switch(t){case"web_app_open_tg_link":case"web_app_open_invoice":case"web_app_setup_back_button":case"web_app_set_background_color":case"web_app_set_header_color":case"web_app_trigger_haptic_feedback":return Q("6.1",e);case"web_app_open_popup":return Q("6.2",e);case"web_app_close_scan_qr_popup":case"web_app_open_scan_qr_popup":case"web_app_read_text_from_clipboard":return Q("6.4",e);case"web_app_switch_inline_query":return Q("6.7",e);case"web_app_invoke_custom_method":case"web_app_request_write_access":case"web_app_request_phone":return Q("6.9",e);case"web_app_setup_settings_button":return Q("6.10",e);case"web_app_biometry_get_info":case"web_app_biometry_open_settings":case"web_app_biometry_request_access":case"web_app_biometry_request_auth":case"web_app_biometry_update_token":return Q("7.2",e);default:return["iframe_ready","iframe_will_reload","web_app_close","web_app_data_send","web_app_expand","web_app_open_link","web_app_ready","web_app_request_theme","web_app_request_viewport","web_app_setup_main_button","web_app_setup_closing_behavior"].includes(t)}}function Z(t){return"external"in t&&$(t.external)&&"notify"in t.external&&"function"==typeof t.external.notify}function X(t){return"TelegramWebviewProxy"in t&&$(t.TelegramWebviewProxy)&&"postEvent"in t.TelegramWebviewProxy&&"function"==typeof t.TelegramWebviewProxy.postEvent}function tt(){try{return window.self!==window.top}catch{return!0}}let et="https://web.telegram.org";function st(t){et=t}function nt(){return et}function rt(t,e,s){let n,r={};if(e||s?e&&s?(r=s,n=e):e&&("targetOrigin"in e?r=e:n=e):r={},function(){h&&c.log(...arguments)}("Posting event:",n?{event:t,data:n}:{event:t}),tt())return window.parent.postMessage(JSON.stringify({eventType:t,eventData:n}),r.targetOrigin||nt());if(Z(window))window.external.notify(JSON.stringify({eventType:t,eventData:n}));else{if(!X(window))throw f(m,"Unable to determine current environment and possible way to send event. You are probably trying to use Mini Apps method outside the Telegram application environment.");window.TelegramWebviewProxy.postEvent(t,JSON.stringify(n))}}function it(t){return(e,s)=>{if(!Y(e,t))throw f(b,'Method "'.concat(e,'" is unsupported in Mini Apps version ').concat(t));if($(s)&&"web_app_set_header_color"===e&&"color"in s&&!Y(e,"color",t))throw f(w,'Parameter "color" of "'.concat(e,'" method is unsupported in Mini Apps version ').concat(t));return rt(e,s)}}function ot(t){return e=>{let{req_id:s}=e;return s===t}}function at(t){return f(y,"Timeout reached: ".concat(t,"ms"))}function ct(t,e){return Promise.race(["function"==typeof t?t():t,new Promise(((t,s)=>{setTimeout((()=>{s(at(e))}),e)}))])}async function ht(t){let e;const s=new Promise((t=>e=t)),{event:n,capture:r,timeout:i}=t,[,o]=_((Array.isArray(n)?n:[n]).map((t=>K(t,(s=>{(!r||(Array.isArray(n)?r({event:t,payload:s}):r(s)))&&e(s)})))));try{return(t.postEvent||rt)(t.method,t.params),await(i?ct(s,i):s)}finally{o()}}async function pt(t,e,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const{result:r,error:i}=await ht({...n,method:"web_app_invoke_custom_method",event:"custom_method_invoked",params:{method:t,params:e,req_id:s},capture:ot(s)});if(i)throw f(v,i);return r}function ut(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return e.map((t=>"string"==typeof t?t:$(t)?ut(Object.entries(t).map((t=>t[1]&&t[0]))):Array.isArray(t)?ut(...t):void 0)).filter(Boolean).join(" ")}function lt(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return e.reduce(((t,e)=>($(e)&&Object.entries(e).forEach((e=>{let[s,n]=e;const r=ut(t[s],n);r.length&&(t[s]=r)})),t)),{})}function dt(t){return/^#[\da-f]{6}$/i.test(t)}function _t(t){return/^#[\da-f]{3}$/i.test(t)}function gt(t){const e=t.replace(/\s/g,"").toLowerCase();if(dt(e))return e;if(_t(e)){let t="#";for(let s=0;s<3;s+=1)t+=e[1+s].repeat(2);return t}const s=e.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||e.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),\d{1,3}\)$/);if(!s)throw new Error('Value "'.concat(t,'" does not satisfy any of known RGB formats.'));return s.slice(1).reduce(((t,e)=>{const s=parseInt(e,10).toString(16);return t+(1===s.length?"0":"")+s}),"#")}function ft(t){const e=gt(t);return Math.sqrt([.299,.587,.114].reduce(((t,s,n)=>{const r=parseInt(e.slice(1+2*n,1+2*(n+1)),16);return t+r*r*s}),0))<120}class bt{constructor(t){r(this,"ee",new l),r(this,"on",this.ee.on.bind(this.ee)),r(this,"off",this.ee.off.bind(this.ee)),this.state=t}clone(){return{...this.state}}set(t,e){Object.entries("string"==typeof t?{[t]:e}:t).reduce(((t,e)=>{let[s,n]=e;return this.state[s]===n||void 0===n?t:(this.state[s]=n,this.ee.emit("change:".concat(s),n),!0)}),!1)&&this.ee.emit("change",this.state)}get(t){return this.state[t]}}class wt{constructor(t){r(this,"state"),r(this,"get"),r(this,"set"),r(this,"clone"),this.state=new bt(t),this.set=this.state.set.bind(this.state),this.get=this.state.get.bind(this.state),this.clone=this.state.clone.bind(this.state)}}function mt(t,e){return s=>Y(e[s],t)}class vt extends wt{constructor(t,e,s){super(t),r(this,"supports"),this.supports=mt(e,s)}}class yt extends vt{constructor(t,e,s){super({isVisible:t},e,{show:"web_app_setup_back_button",hide:"web_app_setup_back_button"}),r(this,"on",((t,e)=>"click"===t?K("back_button_pressed",e):this.state.on(t,e))),r(this,"off",((t,e)=>"click"===t?J("back_button_pressed",e):this.state.off(t,e))),this.postEvent=s}set isVisible(t){this.set("isVisible",t),this.postEvent("web_app_setup_back_button",{is_visible:t})}get isVisible(){return this.get("isVisible")}hide(){this.isVisible=!1}show(){this.isVisible=!0}}const Et=k((t=>t instanceof Date?t:new Date(1e3*V().parse(t))),"Date");function Pt(t,e){return new I((e=>{if("string"!=typeof e&&!(e instanceof URLSearchParams))throw R();const s="string"==typeof e?new URLSearchParams(e):e;return O(t,(t=>{const e=s.get(t);return null===e?void 0:e}))}),!1,e)}const xt=D({id:V(),type:M(),title:M(),photoUrl:{type:M().optional(),from:"photo_url"},username:M().optional()},"Chat").optional(),Ct=D({addedToAttachmentMenu:{type:q().optional(),from:"added_to_attachment_menu"},allowsWriteToPm:{type:q().optional(),from:"allows_write_to_pm"},firstName:{type:M(),from:"first_name"},id:V(),isBot:{type:q().optional(),from:"is_bot"},isPremium:{type:q().optional(),from:"is_premium"},languageCode:{type:M().optional(),from:"language_code"},lastName:{type:M().optional(),from:"last_name"},photoUrl:{type:M().optional(),from:"photo_url"},username:M().optional()},"User").optional();function St(){return Pt({authDate:{type:Et(),from:"auth_date"},canSendAfter:{type:V().optional(),from:"can_send_after"},chat:xt,chatInstance:{type:M().optional(),from:"chat_instance"},chatType:{type:M().optional(),from:"chat_type"},hash:M(),queryId:{type:M().optional(),from:"query_id"},receiver:Ct,startParam:{type:M().optional(),from:"start_param"},user:Ct},"InitData")}const Tt=k((t=>gt(M().parse(t))),"rgb");function At(t){return t.replace(/[A-Z]/g,(t=>"_".concat(t.toLowerCase())))}const Rt=k((t=>{const e=Tt().optional();return Object.entries(N(t)).reduce(((t,s)=>{let[n,r]=s;return t[function(t){return t.replace(/_[a-z]/g,(t=>t[1].toUpperCase()))}(n)]=e.parse(r),t}),{})}),"ThemeParams");function It(t){return Pt({botInline:{type:q().optional(),from:"tgWebAppBotInline"},initData:{type:St().optional(),from:"tgWebAppData"},initDataRaw:{type:M().optional(),from:"tgWebAppData"},platform:{type:M(),from:"tgWebAppPlatform"},showSettings:{type:q().optional(),from:"tgWebAppShowSettings"},startParam:{type:M().optional(),from:"tgWebAppStartParam"},themeParams:{type:Rt(),from:"tgWebAppThemeParams"},version:{type:M(),from:"tgWebAppVersion"}}).parse(t)}function kt(t){return It(t.replace(/^[^?#]*[?#]/,"").replace(/[?#]/g,"&"))}function qt(){return kt(window.location.href)}function Ot(){return performance.getEntriesByType("navigation")[0]}function Nt(){const t=Ot();if(!t)throw new Error("Unable to get first navigation entry.");return kt(t.name)}function Dt(t){return"telegram-apps/".concat(t.replace(/[A-Z]/g,(t=>"-".concat(t.toLowerCase()))))}function Vt(t,e){sessionStorage.setItem(Dt(t),JSON.stringify(e))}function Mt(t){const e=sessionStorage.getItem(Dt(t));try{return e?JSON.parse(e):void 0}catch{}}function Lt(){return It(Mt("launchParams")||"")}function Bt(t){return JSON.stringify(Object.fromEntries(Object.entries(t).map((t=>{let[e,s]=t;return[At(e),s]}))))}function Wt(t){const{initDataRaw:e,themeParams:s,platform:n,version:r,showSettings:i,startParam:o,botInline:a}=t,c=new URLSearchParams;return c.set("tgWebAppPlatform",n),c.set("tgWebAppThemeParams",Bt(s)),c.set("tgWebAppVersion",r),e&&c.set("tgWebAppData",e),o&&c.set("tgWebAppStartParam",o),"boolean"==typeof i&&c.set("tgWebAppShowSettings",i?"1":"0"),"boolean"==typeof a&&c.set("tgWebAppBotInline",a?"1":"0"),c.toString()}function Ut(t){Vt("launchParams",Wt(t))}function Ht(){for(const t of[qt,Nt,Lt])try{const e=t();return Ut(e),e}catch{}throw new Error("Unable to retrieve launch parameters from any known source.")}function Gt(){const t=Ot();return!(!t||"reload"!==t.type)}const[jt]=i((function(){let t=0;return()=>(t+=1).toString()}));function zt(t,e){return()=>{const s=Ht(),n={...s,postEvent:it(s.version),createRequestId:jt()};if("function"==typeof t)return t(n);const[r,i,o]=_(),a=e({...n,state:Gt()?Mt(t):void 0,addCleanup:r}),c=e=>(o||r(e.on("change",(e=>{Vt(t,e)}))),e);return[a instanceof Promise?a.then(c):c(a),i]}}const Jt=zt("backButton",(t=>{let{postEvent:e,version:s,state:n={isVisible:!1}}=t;return new yt(n.isVisible,s,e)}));class Kt extends vt{constructor(){super(...arguments),r(this,"on",this.state.on.bind(this.state)),r(this,"off",this.state.off.bind(this.state))}}function $t(t){const e=t.available?t:{available:!1,device_id:"",token_saved:!1,access_requested:!1,access_granted:!1,type:""};return{available:!0,type:e.type,deviceId:e.device_id,tokenSaved:e.token_saved,accessRequested:e.access_requested,accessGranted:e.access_granted}}class Ft extends Kt{constructor(t){let{postEvent:e,version:s,...n}=t;super(n,s,{auth:"web_app_biometry_request_auth",openSettings:"web_app_biometry_open_settings",requestAccess:"web_app_biometry_request_access",updateToken:"web_app_biometry_update_token"}),r(this,"postEvent"),r(this,"authPromise"),r(this,"accessPromise"),this.postEvent=e}get available(){return this.get("available")}get accessGranted(){return this.get("accessGranted")}get accessRequested(){return this.get("accessRequested")}async authenticate(t){let{reason:e,...s}=t;return this.authPromise||(this.authPromise=ht({...s,method:"web_app_biometry_request_auth",event:"biometry_auth_requested",postEvent:this.postEvent,params:{reason:(e||"").trim()}}).then((t=>{let{token:e}=t;return e})).finally((()=>this.authPromise=void 0))),this.authPromise}get deviceId(){return this.get("deviceId")}openSettings(){this.postEvent("web_app_biometry_open_settings")}requestAccess(){let{reason:t,...e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.accessPromise||(this.accessPromise=ht({...e,postEvent:this.postEvent,method:"web_app_biometry_request_access",event:"biometry_info_received",params:{reason:t||""}}).then((t=>{const e=$t(t);return this.set(e),e.accessGranted})).finally((()=>this.accessPromise=void 0))),this.accessPromise}get biometryType(){return this.get("biometryType")}get tokenSaved(){return this.get("tokenSaved")}async updateToken(){let{token:t,...e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return["removed","updated"].includes((await ht({...e,postEvent:this.postEvent,method:"web_app_biometry_update_token",event:"biometry_token_updated",params:{token:t||""}})).status)}}async function Qt(t){return $t(await ht({...t||{},method:"web_app_biometry_get_info",event:"biometry_info_received"}))}const Yt=zt("biometryManager",(async t=>{let{postEvent:e,version:s,state:n}=t;return new Ft({...n||Y("web_app_biometry_get_info",s)?n||await Qt({timeout:1e3}):{available:!1,accessGranted:!1,accessRequested:!1,tokenSaved:!1,deviceId:""},version:s,postEvent:e})}));class Zt extends wt{constructor(){super(...arguments),r(this,"on",this.state.on.bind(this.state)),r(this,"off",this.state.off.bind(this.state))}}class Xt extends Zt{constructor(t,e){super({isConfirmationNeeded:t}),this.postEvent=e}set isConfirmationNeeded(t){this.set("isConfirmationNeeded",t),this.postEvent("web_app_setup_closing_behavior",{need_confirmation:t})}get isConfirmationNeeded(){return this.get("isConfirmationNeeded")}disableConfirmation(){this.isConfirmationNeeded=!1}enableConfirmation(){this.isConfirmationNeeded=!0}}const te=zt("closingBehavior",(t=>{let{postEvent:e,state:s={isConfirmationNeeded:!1}}=t;return new Xt(s.isConfirmationNeeded,e)}));class ee{constructor(t,e){r(this,"supports"),this.supports=mt(t,e)}}function se(t){if(Array.isArray(t))return t;if("string"==typeof t)try{const e=JSON.parse(t);if(Array.isArray(e))return e}catch{}throw R()}class ne extends I{constructor(t,e,s){super(se,e,s),r(this,"itemParser"),this.itemParser="function"==typeof t?t:t.parse.bind(t)}parse(t){const e=super.parse(t);return void 0===e?e:e.map(this.itemParser)}of(t){return this.itemParser="function"==typeof t?t:t.parse.bind(t),this}}function re(t){return new ne((t=>t),!1,t)}function ie(t,e){return Object.fromEntries(t.map((t=>[t,e])))}class oe extends ee{constructor(t,e,s){super(t,{delete:"web_app_invoke_custom_method",get:"web_app_invoke_custom_method",getKeys:"web_app_invoke_custom_method",set:"web_app_invoke_custom_method"}),this.createRequestId=e,this.postEvent=s}async delete(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=Array.isArray(t)?t:[t];s.length&&await pt("deleteStorageValues",{keys:s},this.createRequestId(),{...e,postEvent:this.postEvent})}async getKeys(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return re().of(M()).parse(await pt("getStorageKeys",{},this.createRequestId(),{...t,postEvent:this.postEvent}))}async get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=Array.isArray(t)?t:[t];if(!s.length)return ie(s,"");const n=await pt("getStorageValues",{keys:s},this.createRequestId(),{...e,postEvent:this.postEvent}),r=D(ie(s,M()),"CloudStorageData").parse(n);return Array.isArray(t)?r:r[t]}async set(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};await pt("saveStorageValue",{key:t,value:e},this.createRequestId(),{...s,postEvent:this.postEvent})}}const ae=zt((t=>{let{createRequestId:e,postEvent:s,version:n}=t;return new oe(n,e,s)}));class ce extends ee{constructor(t,e){super(t,{impactOccurred:"web_app_trigger_haptic_feedback",notificationOccurred:"web_app_trigger_haptic_feedback",selectionChanged:"web_app_trigger_haptic_feedback"}),this.postEvent=e}impactOccurred(t){this.postEvent("web_app_trigger_haptic_feedback",{type:"impact",impact_style:t})}notificationOccurred(t){this.postEvent("web_app_trigger_haptic_feedback",{type:"notification",notification_type:t})}selectionChanged(){this.postEvent("web_app_trigger_haptic_feedback",{type:"selection_change"})}}const he=zt((t=>{let{version:e,postEvent:s}=t;return new ce(e,s)}));class pe{constructor(t){this.initData=t}get authDate(){return this.initData.authDate}get canSendAfter(){return this.initData.canSendAfter}get canSendAfterDate(){const{canSendAfter:t}=this;return t?new Date(this.authDate.getTime()+1e3*t):void 0}get chat(){return this.initData.chat}get chatType(){return this.initData.chatType}get chatInstance(){return this.initData.chatInstance}get hash(){return this.initData.hash}get queryId(){return this.initData.queryId}get receiver(){return this.initData.receiver}get startParam(){return this.initData.startParam}get user(){return this.initData.user}}const ue=zt((t=>{let{initData:e}=t;return e?new pe(e):void 0}));function le(t){return St().parse(t)}class de extends Kt{constructor(t,e,s){super({isOpened:t},e,{open:"web_app_open_invoice"}),this.postEvent=s}set isOpened(t){this.set("isOpened",t)}get isOpened(){return this.get("isOpened")}async open(t,e){if(this.isOpened)throw new Error("Invoice is already opened");let s;if(e){const{hostname:e,pathname:n}=new URL(t,window.location.href);if("t.me"!==e)throw new Error("Incorrect hostname: ".concat(e));const r=n.match(/^\/(\$|invoice\/)([A-Za-z0-9\-_=]+)$/);if(!r)throw new Error('Link pathname has incorrect format. Expected to receive "/invoice/{slug}" or "/${slug}"');[,,s]=r}else s=t;this.isOpened=!0;try{return(await ht({method:"web_app_open_invoice",event:"invoice_closed",params:{slug:s},postEvent:this.postEvent,capture:t=>s===t.slug})).status}finally{this.isOpened=!1}}}const _e=zt((t=>{let{version:e,postEvent:s}=t;return new de(!1,e,s)}));class ge extends wt{constructor(t){let{postEvent:e,...s}=t;super(s),r(this,"postEvent"),r(this,"on",((t,e)=>"click"===t?K("main_button_pressed",e):this.state.on(t,e))),r(this,"off",((t,e)=>"click"===t?J("main_button_pressed",e):this.state.off(t,e))),this.postEvent=e}get bgColor(){return this.get("bgColor")}commit(){""!==this.text&&this.postEvent("web_app_setup_main_button",{is_visible:this.isVisible,is_active:this.isEnabled,is_progress_visible:this.isLoaderVisible,text:this.text,color:this.bgColor,text_color:this.textColor})}disable(){return this.isEnabled=!1,this}enable(){return this.isEnabled=!0,this}hide(){return this.isVisible=!1,this}hideLoader(){return this.isLoaderVisible=!1,this}set isEnabled(t){this.setParams({isEnabled:t})}get isEnabled(){return this.get("isEnabled")}set isLoaderVisible(t){this.setParams({isLoaderVisible:t})}get isLoaderVisible(){return this.get("isLoaderVisible")}set isVisible(t){this.setParams({isVisible:t})}get isVisible(){return this.get("isVisible")}show(){return this.isVisible=!0,this}showLoader(){return this.isLoaderVisible=!0,this}setText(t){return this.setParams({text:t})}setTextColor(t){return this.setParams({textColor:t})}setBgColor(t){return this.setParams({bgColor:t})}setParams(t){return this.set(t),this.commit(),this}get text(){return this.get("text")}get textColor(){return this.get("textColor")}}const fe=zt("mainButton",(t=>{let{postEvent:e,themeParams:s,state:n={isVisible:!1,isEnabled:!1,text:"",isLoaderVisible:!1,textColor:s.buttonTextColor||"#ffffff",bgColor:s.buttonColor||"#000000"}}=t;return new ge({...n,postEvent:e})}));function be(t,e){return s=>{const[n,r]=e[s];return Y(n,r,t)}}function we(t){return new Promise((e=>{setTimeout(e,t)}))}class me extends Kt{constructor(t){let{postEvent:e,createRequestId:s,version:n,botInline:i,...o}=t;super(o,n,{requestPhoneAccess:"web_app_request_phone",requestWriteAccess:"web_app_request_write_access",switchInlineQuery:"web_app_switch_inline_query",setHeaderColor:"web_app_set_header_color",setBackgroundColor:"web_app_set_background_color"}),r(this,"botInline"),r(this,"postEvent"),r(this,"createRequestId"),r(this,"requestPhoneAccessPromise"),r(this,"requestWriteAccessPromise"),r(this,"supportsParam"),this.createRequestId=s,this.postEvent=e,this.botInline=i;const a=this.supports.bind(this);this.supports=t=>!!a(t)&&("switchInlineQuery"!==t||i),this.supportsParam=be(n,{"setHeaderColor.color":["web_app_set_header_color","color"]})}async getRequestedContact(){let{timeout:t=1e4}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Pt({contact:D({userId:{type:V(),from:"user_id"},phoneNumber:{type:M(),from:"phone_number"},firstName:{type:M(),from:"first_name"},lastName:{type:M().optional(),from:"last_name"}}),authDate:{type:Et(),from:"auth_date"},hash:M()},"RequestedContact").parse(await pt("getRequestedContact",{},this.createRequestId(),{postEvent:this.postEvent,timeout:t}))}get bgColor(){return this.get("bgColor")}close(t){this.postEvent("web_app_close",{return_back:t})}get headerColor(){return this.get("headerColor")}get isBotInline(){return this.botInline}get isDark(){return ft(this.bgColor)}ready(){this.postEvent("web_app_ready")}async requestContact(){let{timeout:t=5e3}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return await this.getRequestedContact()}catch{}if("sent"!==await this.requestPhoneAccess())throw new Error("Access denied.");const e=Date.now()+t;let s=50;return ct((async()=>{for(;Date.now()<e;){try{return await this.getRequestedContact()}catch{}await we(s),s+=50}throw at(t)}),t)}async requestPhoneAccess(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.requestPhoneAccessPromise||(this.requestPhoneAccessPromise=ht({...t,method:"web_app_request_phone",event:"phone_requested",postEvent:this.postEvent}).then((t=>{let{status:e}=t;return e})).finally((()=>this.requestPhoneAccessPromise=void 0))),this.requestPhoneAccessPromise}async requestWriteAccess(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.requestWriteAccessPromise||(this.requestWriteAccessPromise=ht({...t,method:"web_app_request_write_access",event:"write_access_requested",postEvent:this.postEvent}).then((t=>{let{status:e}=t;return e})).finally((()=>this.requestWriteAccessPromise=void 0))),this.requestWriteAccessPromise}sendData(t){const{size:e}=new Blob([t]);if(!e||e>4096)throw new Error("Passed data has incorrect size: ".concat(e));this.postEvent("web_app_data_send",{data:t})}setHeaderColor(t){this.postEvent("web_app_set_header_color",dt(t)?{color:t}:{color_key:t}),this.set("headerColor",t)}setBgColor(t){this.postEvent("web_app_set_background_color",{color:t}),this.set("bgColor",t)}switchInlineQuery(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!this.supports("switchInlineQuery")&&!this.isBotInline)throw new Error("Method is unsupported because Mini App should be launched in inline mode.");this.postEvent("web_app_switch_inline_query",{query:t,chat_types:e})}}const ve=zt("miniApp",(t=>{let{themeParams:e,botInline:s=!1,state:n={bgColor:e.bgColor||"#ffffff",headerColor:e.headerBgColor||"#000000"},...r}=t;return new me({...r,...n,botInline:s})}));function ye(t){const e=t.message.trim(),s=(t.title||"").trim(),n=t.buttons||[];let r;if(s.length>64)throw new Error("Title has incorrect size: ".concat(s.length));if(!e.length||e.length>256)throw new Error("Message has incorrect size: ".concat(e.length));if(n.length>3)throw new Error("Buttons have incorrect size: ".concat(n.length));return r=n.length?n.map((t=>{const{id:e=""}=t;if(e.length>64)throw new Error("Button ID has incorrect size: ".concat(e));if(!t.type||"default"===t.type||"destructive"===t.type){const s=t.text.trim();if(!s.length||s.length>64){const e=t.type||"default";throw new Error('Button text with type "'.concat(e,'" has incorrect size: ').concat(t.text.length))}return{...t,text:s,id:e}}return{...t,id:e}})):[{type:"close",id:""}],{title:s,message:e,buttons:r}}class Ee extends Kt{constructor(t,e,s){super({isOpened:t},e,{open:"web_app_open_popup"}),this.postEvent=s}set isOpened(t){this.set("isOpened",t)}get isOpened(){return this.get("isOpened")}async open(t){if(this.isOpened)throw new Error("Popup is already opened.");this.isOpened=!0;try{const{button_id:e=null}=await ht({event:"popup_closed",method:"web_app_open_popup",postEvent:this.postEvent,params:ye(t)});return e}finally{this.isOpened=!1}}}const Pe=zt((t=>{let{postEvent:e,version:s}=t;return new Ee(!1,s,e)}));class xe extends Kt{constructor(t,e,s){super({isOpened:t},e,{close:"web_app_close_scan_qr_popup",open:"web_app_open_scan_qr_popup"}),this.postEvent=s}close(){this.postEvent("web_app_close_scan_qr_popup"),this.isOpened=!1}set isOpened(t){this.set("isOpened",t)}get isOpened(){return this.get("isOpened")}async open(t){if(this.isOpened)throw new Error("The scanner is already opened");const{text:e,capture:s}=("string"==typeof t?{text:t}:t)||{};this.isOpened=!0;try{const t=(await ht({method:"web_app_open_scan_qr_popup",event:["qr_text_received","scan_qr_popup_closed"],postEvent:this.postEvent,params:{text:e},capture:t=>"scan_qr_popup_closed"===t.event||!s||s(t.payload)})||{}).data||null;return t&&this.close(),t}finally{this.isOpened=!1}}}const Ce=zt((t=>{let{version:e,postEvent:s}=t;return new xe(!1,e,s)}));class Se extends vt{constructor(t,e,s){super({isVisible:t},e,{show:"web_app_setup_settings_button",hide:"web_app_setup_settings_button"}),r(this,"on",((t,e)=>"click"===t?K("settings_button_pressed",e):this.state.on(t,e))),r(this,"off",((t,e)=>"click"===t?J("settings_button_pressed",e):this.state.off(t,e))),this.postEvent=s}set isVisible(t){this.set("isVisible",t),this.postEvent("web_app_setup_settings_button",{is_visible:t})}get isVisible(){return this.get("isVisible")}hide(){this.isVisible=!1}show(){this.isVisible=!0}}const Te=zt("settingsButton",(t=>{let{version:e,postEvent:s,state:n={isVisible:!1}}=t;return new Se(n.isVisible,e,s)}));function Ae(t){return Rt().parse(t)}class Re extends Zt{get accentTextColor(){return this.get("accentTextColor")}get bgColor(){return this.get("bgColor")}get buttonColor(){return this.get("buttonColor")}get buttonTextColor(){return this.get("buttonTextColor")}get destructiveTextColor(){return this.get("destructiveTextColor")}getState(){return this.clone()}get headerBgColor(){return this.get("headerBgColor")}get hintColor(){return this.get("hintColor")}get isDark(){return!this.bgColor||ft(this.bgColor)}get linkColor(){return this.get("linkColor")}get secondaryBgColor(){return this.get("secondaryBgColor")}get sectionBgColor(){return this.get("sectionBgColor")}get sectionHeaderTextColor(){return this.get("sectionHeaderTextColor")}get sectionSeparatorColor(){return this.get("sectionHeaderTextColor")}listen(){return K("theme_changed",(t=>{this.set(Ae(t.theme_params))}))}get subtitleTextColor(){return this.get("subtitleTextColor")}get textColor(){return this.get("textColor")}}const Ie=zt("themeParams",(t=>{let{themeParams:e,state:s=e,addCleanup:n}=t;const r=new Re(s);return n(r.listen()),r}));function ke(){return ht({...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},method:"web_app_request_theme",event:"theme_changed"}).then(Ae)}function qe(t,e){return t.startsWith(e)?t:"".concat(e).concat(t)}function Oe(t){return new URL("string"==typeof t?t:"".concat(t.pathname||"").concat(qe(t.search||"","?")).concat(qe(t.hash||"","#")),"http://a")}class Ne extends ee{constructor(t,e,s){super(t,{readTextFromClipboard:"web_app_read_text_from_clipboard"}),r(this,"supportsParam"),this.version=t,this.createRequestId=e,this.postEvent=s,this.supportsParam=be(t,{"openLink.tryInstantView":["web_app_open_link","try_instant_view"]})}openLink(t,e){const s=Oe(t).toString();if(!Y("web_app_open_link",this.version))return void window.open(s,"_blank");const n="boolean"==typeof e?{tryInstantView:e}:e||{};this.postEvent("web_app_open_link",{url:s,try_browser:n.tryBrowser,try_instant_view:n.tryInstantView})}openTelegramLink(t){const{hostname:e,pathname:s,search:n}=new URL(t,"https://t.me");if("t.me"!==e)throw new Error("URL has not allowed hostname: ".concat(e,'. Only "t.me" is allowed'));Y("web_app_open_tg_link",this.version)?this.postEvent("web_app_open_tg_link",{path_full:s+n}):window.location.href=t}async readTextFromClipboard(){const t=this.createRequestId(),{data:e=null}=await ht({method:"web_app_read_text_from_clipboard",event:"clipboard_text_received",postEvent:this.postEvent,params:{req_id:t},capture:ot(t)});return e}shareURL(t,e){this.openTelegramLink("https://t.me/share/url?"+new URLSearchParams({url:t,text:e||""}).toString().replace(/\+/g,"%20"))}}const De=zt((t=>{let{version:e,postEvent:s,createRequestId:n}=t;return new Ne(e,n,s)}));async function Ve(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{is_expanded:e,is_state_stable:s,...n}=await ht({...t,method:"web_app_request_viewport",event:"viewport_changed"});return{...n,isExpanded:e,isStateStable:s}}function Me(t){return t<0?0:t}class Le extends Zt{constructor(t){let{postEvent:e,stableHeight:s,height:n,width:i,isExpanded:o}=t;super({height:Me(n),isExpanded:o,stableHeight:Me(s),width:Me(i)}),r(this,"postEvent"),this.postEvent=e}async sync(t){const{isStateStable:e,...s}=await Ve(t);this.set({...s,stableHeight:e?s.height:this.get("stableHeight")})}get height(){return this.get("height")}get stableHeight(){return this.get("stableHeight")}listen(){return K("viewport_changed",(t=>{const{height:e,width:s,is_expanded:n,is_state_stable:r}=t,i=Me(e);this.set({height:i,isExpanded:n,width:Me(s),...r?{stableHeight:i}:{}})}))}get isExpanded(){return this.get("isExpanded")}get width(){return this.get("width")}expand(){this.postEvent("web_app_expand"),this.set("isExpanded",!0)}get isStable(){return this.stableHeight===this.height}}const Be=zt("viewport",(async t=>{let{state:e,platform:s,postEvent:n,addCleanup:r}=t,i=!1,o=0,a=0,c=0;if(e)i=e.isExpanded,o=e.height,a=e.width,c=e.stableHeight;else if(["macos","tdesktop","unigram","webk","weba","web"].includes(s))i=!0,o=window.innerHeight,a=window.innerWidth,c=window.innerHeight;else{const t=await Ve({timeout:1e3,postEvent:n});i=t.isExpanded,o=t.height,a=t.width,c=t.isStateStable?o:0}const h=new Le({postEvent:n,height:o,width:a,stableHeight:c,isExpanded:i});return r(h.listen()),h}));function We(t,e){document.documentElement.style.setProperty(t,e)}function Ue(t,e,s){s||(s=t=>"--tg-".concat(t,"-color"));const n=s("header"),r=s("bg"),i=()=>{const{headerColor:s}=t;if(dt(s))We(n,s);else{const{bgColor:t,secondaryBgColor:r}=e;"bg_color"===s&&t?We(n,t):"secondary_bg_color"===s&&r&&We(n,r)}We(r,t.bgColor)},o=[e.on("change",i),t.on("change",i)];return i(),()=>o.forEach((t=>t()))}function He(t,e){e||(e=t=>"--tg-theme-".concat(t.replace(/[A-Z]/g,(t=>"-".concat(t.toLowerCase())))));const s=()=>{Object.entries(t.getState()).forEach((t=>{let[s,n]=t;n&&We(e(s),n)}))};return s(),t.on("change",s)}function Ge(t,e){e||(e=t=>"--tg-viewport-".concat(t));const[s,n,r]=["height","width","stable-height"].map((t=>e(t))),i=()=>We(s,"".concat(t.height,"px")),o=()=>We(n,"".concat(t.width,"px")),a=()=>We(r,"".concat(t.stableHeight,"px")),c=[t.on("change:height",i),t.on("change:width",o),t.on("change:stableHeight",a)];return i(),o(),a(),()=>c.forEach((t=>t()))}function je(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const e=[K("reload_iframe",(()=>{rt("iframe_will_reload"),window.location.reload()}))];if(t){const t=document.createElement("style");t.id="telegram-custom-styles",document.head.appendChild(t),e.push(K("set_custom_style",(e=>{t.innerHTML=e})),(()=>document.head.removeChild(t)))}return rt("iframe_ready",{reload_supported:!0}),()=>e.forEach((t=>t()))}function ze(){return typeof window>"u"}async function Je(){if(X(window))return!0;try{return await ht({method:"web_app_request_theme",event:"theme_changed",timeout:100}),!0}catch{return!1}}function Ke(t){const e="string"==typeof t?It(t):t;function s(t){if("string"==typeof t)try{const{eventType:s}=L(t);"web_app_request_theme"===s&&W("theme_changed",{theme_params:JSON.parse(Bt(e.themeParams))}),"web_app_request_viewport"===s&&W("viewport_changed",{width:window.innerWidth,height:window.innerHeight,is_state_stable:!0,is_expanded:!0})}catch{}}if(Ut(e),tt()){const t=window.parent.postMessage.bind(window.parent);return void(window.parent.postMessage=e=>{s(e),t(e)})}if(Z(window)){const t=window.external.notify.bind(window.external);return void(window.external.notify=e=>{s(e),t(e)})}const n=window.TelegramWebviewProxy;window.TelegramWebviewProxy={...n||{},postEvent(){s(JSON.stringify({eventType:arguments.length<=0?void 0:arguments[0],eventData:arguments.length<=1?void 0:arguments[1]})),n&&n.postEvent(...arguments)}}}function $e(t){return t instanceof g}function Fe(t,e){return $e(t)&&t.type===e}function Qe(t,e){let s,n,r;return"string"==typeof t?s=t:(s=void 0===t.pathname?e:t.pathname,n=t.params,r=t.id),Object.freeze({id:r||(16384*Math.random()|0).toString(16),pathname:s,params:n})}class Ye{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rt;if(r(this,"history"),r(this,"ee",new l),r(this,"attached",!1),r(this,"back",(()=>this.go(-1))),r(this,"on",this.ee.on.bind(this.ee)),r(this,"off",this.ee.off.bind(this.ee)),this._index=e,this.postEvent=s,0===t.length)throw f(x,"History should not be empty.");if(e<0||e>=t.length)throw f(C,"Index should not be zero and higher or equal than history size.");this.history=t.map((t=>Qe(t,"")))}attach(){this.attached||(this.attached=!0,this.sync(),K("back_button_pressed",this.back))}get current(){return this.history[this.index]}detach(){this.attached=!1,J("back_button_pressed",this.back)}forward(){this.go(1)}go(t,e){const s=this.index+t,n=Math.min(Math.max(0,s),this.history.length-1);(s===n||e)&&this.replaceAndMove(n,this.history[n])}goTo(t,e){this.go(t-this.index,e)}get hasPrev(){return this.index>0}get hasNext(){return this.index!==this.history.length-1}get index(){return this._index}push(t){this.hasNext&&this.history.splice(this.index+1),this.replaceAndMove(this.index+1,Qe(t,this.current.pathname))}replace(t){this.replaceAndMove(this.index,Qe(t,this.current.pathname))}replaceAndMove(t,e){const s=t-this.index;if(!s&&this.current===e)return;const n=this.current;if(this.index!==t){const e=this._index;this._index=t,this.attached&&e>0!=t>0&&this.sync()}this.history[t]=e,this.ee.emit("change",{navigator:this,from:n,to:this.current,delta:s})}sync(){this.postEvent("web_app_setup_back_button",{is_visible:!!this.index})}}function Ze(t){let{params:e,...s}=t;return{...e||{hash:"",search:""},...s}}function Xe(t){const e="string"==typeof t?t.startsWith("/"):!(!t.pathname||!t.pathname.startsWith("/")),s=Oe(t);return"".concat(e?s.pathname:s.pathname.slice(1)).concat(s.search).concat(s.hash)}function ts(t,e,s){let n,r;"string"==typeof t?n=t:(n=Xe(t),s=t.state,r=t.id);const{pathname:i,search:o,hash:a}=new URL(n,"http://a".concat(qe(e,"/")));return{id:r,pathname:i,params:{hash:a,search:o,state:s}}}async function es(t){return 0===t||Promise.race([new Promise((e=>{const s=d("popstate",(()=>{s(),e(!0)}));window.history.go(t)})),new Promise((t=>{setTimeout(t,50,!1)}))])}function ss(t){return Oe(t).pathname}class ns{constructor(t,e){let{postEvent:s,hashMode:n="classic",base:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r(this,"navigator"),r(this,"ee",new l),r(this,"hashMode"),r(this,"base"),r(this,"attached",!1),r(this,"onPopState",(t=>{let{state:e}=t;if(null===e)return this.push(this.parsePath(window.location.href));0===e?window.history.forward():1===e&&this.back(),2===e&&this.forward()})),r(this,"onNavigatorChange",(async t=>{let{to:e,from:s,delta:n}=t;this.attached&&await this.syncHistory(),this.ee.emit("change",{delta:n,from:Ze(s),to:Ze(e),navigator:this})})),r(this,"on",this.ee.on.bind(this.ee)),r(this,"off",this.ee.off.bind(this.ee)),this.navigator=new Ye(t.map((t=>ts(t,"/"))),e,s),this.navigator.on("change",(t=>{this.onNavigatorChange(t)})),this.hashMode=n,this.base=ss(i||"")}async attach(){this.attached||(this.attached=!0,this.navigator.attach(),window.addEventListener("popstate",this.onPopState),await this.syncHistory())}back(){this.navigator.back()}detach(){this.attached=!1,this.navigator.detach(),window.removeEventListener("popstate",this.onPopState)}forward(){return this.navigator.forward()}get index(){return this.navigator.index}get id(){return this.navigator.current.id}go(t,e){return this.navigator.go(t,e)}goTo(t,e){this.navigator.goTo(t,e)}get hash(){return(this.navigator.current.params||{}).hash||""}get hasPrev(){return this.navigator.hasPrev}get hasNext(){return this.navigator.hasNext}get history(){return this.navigator.history.map(Ze)}get path(){return Xe(this)}get pathname(){return this.navigator.current.pathname}parsePath(t){let e=Oe(t);return this.hashMode&&(e=Oe(e.hash.slice(1))),{pathname:e.pathname,search:e.search,hash:e.hash}}push(t,e){const s=ts(t,this.path),{state:n=e}=s.params;this.navigator.push({...s,params:{...s.params,state:n}})}replace(t,e){const s=ts(t,this.path),{state:n=e}=s.params;this.navigator.replace({...s,params:{...s.params,state:n}})}renderPath(t){const e=(1===this.base.length?"":this.base)+qe(Xe(t),"/");return this.hashMode?qe(e.slice(1),"classic"===this.hashMode?"#":"#/"):e}async syncHistory(){window.removeEventListener("popstate",this.onPopState);const{state:t}=this,e=this.renderPath(this);await async function(){if(window.history.length<=1||(window.history.pushState(null,""),await es(1-window.history.length)))return;let t=await es(-1);for(;t;)t=await es(-1)}(),this.hasPrev&&this.hasNext?(window.history.replaceState(1,""),window.history.pushState(t,"",e),window.history.pushState(2,""),await es(-1)):this.hasPrev?(window.history.replaceState(1,""),window.history.pushState(t,"",e)):this.hasNext?(window.history.replaceState(t,e),window.history.pushState(2,""),await es(-1)):(window.history.replaceState(0,""),window.history.pushState(t,"",e)),window.addEventListener("popstate",this.onPopState)}get search(){return(this.navigator.current.params||{}).search||""}get state(){return(this.navigator.current.params||{}).state}}function rs(t){t||(t={});const{href:e,hash:s}=window.location;let n=Xe(null===t.hashMode?e:s.includes("?")?s.slice(1):"?".concat(s.slice(1)));const r=t.base?ss(t.base):void 0;if(r){if(!n.startsWith(r))throw f(A,'Path "'.concat(n,'" expected to be starting with "').concat(r,'"'));n=n.slice(r.length)}return new ns([n],0,t)}function is(t){const e=t.match(/#(.+)/);return e?e[1]:null}function os(t,e){const s=function(t,e){if(Gt()){const s=sessionStorage.getItem(t);if(s)try{const{index:t,history:n}=JSON.parse(s);return new ns(n,t,e)}catch(n){console.error("Unable to restore hash navigator state.",n)}}return rs(e)}(t,e),n=()=>sessionStorage.setItem(t,JSON.stringify({index:s.index,history:s.history}));return s.on("change",n),n(),s}}}]);
//# sourceMappingURL=605.3d41e232.chunk.js.map